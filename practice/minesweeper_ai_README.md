# 지뢰찾기 AI (Minesweeper AI)

이 프로젝트는 딥러닝을 활용하여 지뢰찾기 게임을 자동으로 플레이하는 AI 시스템을 구현합니다. 강화학습(Reinforcement Learning)과 딥 Q-네트워크(Deep Q-Network)를 사용하여 AI가 게임을 플레이하고 경험을 통해 학습합니다.

## 프로젝트 구성

- `minesweeper.py`: 지뢰찾기 게임 구현 (기존 파일)
- `minesweeper_ai.py`: 딥러닝 기반 AI 에이전트 구현
- `run_minesweeper_ai.py`: AI 실행을 위한 사용자 인터페이스

## 필요 라이브러리

이 프로젝트를 실행하기 위해 다음 라이브러리가 필요합니다:

```
tensorflow
numpy
tkinter (Python 기본 라이브러리)
```

## 설치 방법

필요한 라이브러리를 설치합니다:

```bash
pip install tensorflow numpy
```

## 사용 방법

1. `minesweeper_ai.py` 스크립트를 직접 실행합니다:

```bash
python minesweeper_ai.py
```

2. 고급 기능 사용 여부를 선택합니다:
   - 기본 기능: 원래 버전과 동일한 기능
   - 고급 기능: 새로 추가된 모든 기능 사용 가능

### 기본 기능 모드

1. 난이도는 초급(9x9, 지뢰 10개)으로 자동 설정됩니다.

2. 모드를 선택합니다:
   - AI 학습 시작: 새로운 모델을 학습시킵니다
   - 학습된 AI로 게임 플레이: 이미 학습된 모델로 게임을 플레이합니다

3. 학습 모드를 선택한 경우:
   - 학습 에피소드 수를 설정합니다 (기본: 1000)
   - 학습 과정 시각화 여부를 선택합니다
   - 학습이 완료된 후 게임 플레이 여부를 선택합니다

### 고급 기능 모드

1. 에이전트 유형을 선택합니다:
   - 단일 에이전트: 하나의 난이도에 대해 학습
   - 메타 학습 에이전트: 여러 난이도에서 동시에 학습

2. 단일 에이전트를 선택한 경우:
   - 난이도를 선택합니다 (초급, 중급, 고급, 커스텀)
   - 신경망 아키텍처를 선택합니다 (CNN, ResNet, DenseNet)
   - 확률적 추론 사용 여부를 선택합니다
   - 자가 대전 사용 여부를 선택합니다
   - 학습 또는 플레이 모드를 선택합니다

3. 메타 학습 에이전트를 선택한 경우:
   - 신경망 아키텍처를 선택합니다 (CNN, ResNet, DenseNet)
   - 확률적 추론 사용 여부를 선택합니다
   - 모든 난이도 학습 또는 게임 플레이 모드를 선택합니다
   - 학습 모드를 선택한 경우:
     - 난이도별 학습 에피소드 수를 설정합니다
     - 학습 과정 시각화 여부를 선택합니다
     - 자가 대전 사용 여부를 선택합니다
   - 게임 플레이 모드를 선택한 경우:
     - 플레이할 난이도를 선택합니다

## AI 구현 설명

### 게임 상태 표현

게임 상태는 2D 행렬로 표현됩니다:
- 0: 아직 열리지 않은 셀
- -1: 깃발이 꽂힌 셀
- 1-8: 주변 지뢰 수를 나타내는 숫자
- 9: 빈 셀 (주변에 지뢰가 없음)

### 행동 정의

AI는 다음 세 가지 행동을 수행할 수 있습니다:
- 왼쪽 클릭: 셀을 열기
- 오른쪽 클릭: 깃발 설치/제거
- 코드 클릭: 이미 열린 숫자 셀 주변의 셀들을 자동으로 열기

### 딥 Q-네트워크 (DQN)

AI는 컨볼루션 신경망(CNN)을 사용한 딥 Q-네트워크를 통해 학습합니다:
- 입력: 게임 보드 상태 (2D 행렬)
- 출력: 각 셀과 행동에 대한 Q-값
- 보상 체계:
  - 승리: +10
  - 패배: -10
  - 셀 열기: +0.1 (열린 셀 수에 비례)
  - 지뢰에 깃발 설치: +0.2
  - 비지뢰에 깃발 설치: -0.1

### 학습 과정

1. 무작위 위치에서 첫 번째 클릭 (항상 안전)
2. 현재 상태 관찰
3. ε-greedy 정책에 따라 행동 선택 (탐험과 활용 균형)
4. 행동 실행 및 보상 획득
5. 경험 메모리에 저장
6. 미니배치로 신경망 학습
7. 타겟 네트워크 주기적 업데이트

## 모델 저장 및 로드

학습된 모델은 다음 형식의 파일로 저장됩니다:
```
minesweeper_model_<width>x<height>_<mines>.h5
```

예: `minesweeper_model_9x9_10.h5` (초급 난이도)

## 성능 및 한계

- AI는 확률적 추론과 패턴 인식을 통해 게임을 플레이합니다
- 충분한 학습 후에는 초급 난이도에서 높은 승률을 보입니다
- 고급 난이도에서는 더 많은 학습이 필요합니다
- 일부 상황에서는 운에 의존해야 하는 경우가 있습니다 (지뢰찾기의 본질적 특성)

## 고급 기능

### 자동 재시작 기능

지뢰를 밟았을 때 자동으로 확인 버튼을 누르고 게임을 재시작하여 학습을 계속합니다. 이 기능은 학습 효율성을 크게 향상시킵니다.

### 하드웨어 가속 및 성능 최적화

Intel CPU와 GPU를 모두 활용하여 학습 성능을 향상시킵니다:
- GPU 자동 감지 및 메모리 최적화
- 혼합 정밀도 학습 (mixed precision training)으로 학습 속도 향상
- Intel CPU 최적화 (oneDNN 가속)
- 배치 처리 최적화로 CPU 부하 감소
- 학습 주기 조정으로 리소스 사용 효율화
- 자동 디바이스 선택 및 오류 복구 메커니즘

### 확률적 추론 알고리즘

딥러닝과 함께 논리적 추론 알고리즘을 사용하여 더 정확한 의사 결정을 합니다:
- 확실한 지뢰 위치 식별
- 안전한 셀 식별
- 제약 조건 분석을 통한 고급 추론

### 자가 대전 메커니즘

AI가 자신과 대전하며 경험을 축적하고 학습합니다:
- 게임 전체 기록 유지
- 최종 결과를 바탕으로 모든 행동 평가
- 경험 재활용을 통한 학습 효율성 향상
- 최적화된 배치 학습으로 성능 향상

### 다양한 신경망 아키텍처

세 가지 다른 신경망 아키텍처를 선택할 수 있습니다:
- CNN: 기본 컨볼루션 신경망
- ResNet: 잔차 연결을 사용한 심층 신경망
- DenseNet: 밀집 연결을 사용한 고급 신경망

### 메타 학습 기능

여러 게임 구성(난이도)에서 학습하고 지식을 전이합니다:
- 여러 난이도에서 동시에 학습
- 경험 공유를 통한 지식 전이
- 새로운 게임 구성에 대한 일반화 능력 향상
